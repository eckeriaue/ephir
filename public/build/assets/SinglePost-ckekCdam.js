import{d as I,r as d,q as L,o as a,c as n,b as t,N as C,k as v,j as w,F as N,l as k,t as o,u as _,e as f,y as j,R as M,A as P,w as A,p as $,U as B,V as F,h as S,i as O,T as R}from"./app-q0qEhKca.js";import{_ as T}from"./Posts-rpicN6R7.js";import{a as U}from"./InputLabel-JrlsIlkA.js";import{_ as V}from"./_plugin-vue_export-helper-x3n3nnut.js";const E=c=>(B("data-v-3555da1a"),c=c(),F(),c),q={class:"min-h-0"},H=E(()=>t("h2",{class:"text-xs font-medium px-6 pb-2 uppercase"}," КОММЕНТАРИИ ",-1)),Z={class:"text-gray-500 text-xs inline-block"},z=["textContent"],G={class:"text-sm text-gray-800"},J=["datetime"],K=["inert"],Q=I({__name:"PostComments",props:{postId:{}},emits:["create"],setup(c,{emit:s}){const y=c,h=s,r=d(!0),u=d(),i=d("");async function x(){r.value=!0;const p=await fetch(await $(`/api/v1/posts/${y.postId}/comments/create`,{method:"POST",body:{comment:_(i)}})).then(l=>l.json());await b(),i.value="",h("create",p)}const g=new Intl.DateTimeFormat("ru-RU",{dateStyle:"long",timeStyle:"short",timeZone:"Europe/Moscow"}),b=async()=>{const p=await fetch(await $(`/api/v1/posts/${y.postId}/comments?limit=999`)).then(l=>l.json()).finally(()=>r.value=!1);u.value=p};return L(b),(p,l)=>(a(),n("section",null,[t("div",q,[H,t("div",{class:C(["grid duration-500 transition-all",{"grid-rows-[0fr]":!u.value,"grid-rows-[1fr]":Array.isArray(u.value)}])},[v(M,{name:"list",tag:"ol",class:"space-y-4 px-6 min-h-0"},{default:w(()=>[(a(!0),n(N,null,j(u.value,e=>{var m;return a(),n("li",{key:e.id},[t("address",Z,[k(" Автор: "),t("a",{role:"author",href:"#",textContent:o((m=e.user)==null?void 0:m.name)},null,8,z)]),t("p",G,o(e.content),1),e.created_at?(a(),n("time",{key:0,datetime:new Date(e.created_at).toISOString(),class:"text-gray-500 text-[10px]"},o(_(g).format(new Date(e.created_at))),9,J)):f("",!0)])}),128))]),_:1})],2),_(P)?(a(),n("form",{key:0,inert:r.value,class:C([{"opacity-50":r.value},"sticky bottom-0 flex items-center group w-full mt-6"]),action:"post",onSubmit:A(x,["prevent"])},[v(U,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=e=>i.value=e),class:"h-[36px] grow rounded-t-none rounded-r-none",placeholder:"Напишите свой комментарий"},null,8,["modelValue"]),v(T,{class:"h-[36px] group-focus-within:border-b-lime-600 border-b-2 rounded-l-none"},{default:w(()=>[k("📨")]),_:1})],42,K)):f("",!0)])]))}}),W=V(Q,[["__scopeId","data-v-3555da1a"]]),X=["data-id"],Y={class:"flex justify-between lg:items-center pb-6 flex-col lg:flex-row"},ee={class:"font-medium text-xl"},te=["datetime"],se=["innerHTML"],ae={class:"flex justify-between"},oe={key:0,class:"text-gray-500 text-xs inline-block"},ne=["textContent"],re={class:"flex items-center gap-x-2"},ie=["disabled"],le=I({__name:"SinglePost",props:{id:{default:NaN},title:{default:""},likes_count:{},my_like:{},user:{default:()=>({})},comments_count:{},content:{default:""},created_at:{}},setup(c){const s=c,y=new Intl.DateTimeFormat("ru-RU",{dateStyle:"medium",timeZone:"Europe/Moscow"}),h=d(!1),r=d(!1),u=d(s.likes_count),i=d(s.my_like),x=d(s.comments_count),g=S(()=>_(i)&&"id"in _(i));async function b(){h.value=!0,await fetch(await $(`/api/v1/posts/${s.id}/like`,{method:"POST"})).then(e=>e.json()).then(e=>{u.value=e.likes,i.value=e.my_like}).finally(()=>h.value=!1)}const p=S(()=>s.created_at?y.format(new Date(s.created_at)):""),l=new Date(s.created_at).toISOString();return(e,m)=>(a(),n("article",{"data-id":e.$props.id,class:"text-gray-700 mb-7 bg-white rounded-xl p-6 border-b-2 border-gray-200"},[t("header",Y,[t("h1",ee,o(e.title),1),s.created_at?(a(),n("time",{key:0,class:"text-gray-500 text-xs",datetime:_(l)},o(p.value),9,te)):f("",!0)]),e.content?(a(),n("p",{key:0,class:"break-words mb-8",innerHTML:e.content},null,8,se)):f("",!0),t("footer",ae,[e.user&&"name"in e.user?(a(),n("address",oe,[k(" Автор: "),t("a",{rel:"author",href:"#",textContent:o(e.user.name)},null,8,ne)])):f("",!0),t("fieldset",re,[v(T,{onClick:m[0]||(m[0]=D=>r.value=!r.value)},{default:w(()=>[k(" 💬 "+o(x.value),1)]),_:1}),t("button",{type:"button",disabled:h.value,class:C([{"bg-red-600 border-transparent  text-white   hover:bg-red-500 active:bg-red-700  focus:ring-2 focus:ring-red-500":g.value,"bg-white border-gray-300 text-gray-700 shadow-sm hover:bg-gray-50 focus:ring-2 focus:ring-lime-500":!g.value},"px-4 py-2 disabled:pointer-events-none border inline-flex items-center tracking-widest uppercase focus:outline-none rounded-md disabled:opacity-25 font-semibold text-xs focus:ring-offset-2 transition ease-in-out duration-150"]),onClick:b},o(g.value?"🤍":"❤️")+" "+o(u.value),11,ie)])]),v(R,null,{default:w(()=>[r.value?(a(),O(W,{key:0,onCreate:m[1]||(m[1]=D=>x.value+=1),"post-id":e.$props.id,class:"transition-all duration-500 overflow-hidden mt-6 -mx-6 -mb-6"},null,8,["post-id"])):f("",!0)]),_:1})],8,X))}}),pe=V(le,[["__scopeId","data-v-fa958297"]]);export{pe as default};
