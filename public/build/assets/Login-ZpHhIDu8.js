import{k as d,l as O,S as T,m as I,n as C,p as A,q as y,O as m,s as U,u as V,v as P,x as R,y as B,z as F,A as $,a as b,b as w,B as N,C as x,d as G,D as j,E as q,G as z,t as D,H as M,g as f,h as v,w as J,j as K,I as Y,i as H,J as Q,F as X,K as Z,L as W}from"./app-RsO0nGxX.js";import{_ as ee}from"./_plugin-vue_export-helper-x3n3nnut.js";import{a as _,_ as g,P as re}from"./TextInput.vue_vue_type_script_setup_true_lang-BE33fIav.js";function te(e){return d(e==null?void 0:e.lift)}function ne(e){return function(t){if(te(t))return t.lift(function(r){try{return e(r,this)}catch(n){this.error(n)}});throw new TypeError("Unable to lift unknown Observable type")}}function k(e,t,r,n,o){return new oe(e,t,r,n,o)}var oe=function(e){O(t,e);function t(r,n,o,s,a,l){var c=e.call(this,r)||this;return c.onFinalize=a,c.shouldUnsubscribe=l,c._next=n?function(i){try{n(i)}catch(u){r.error(u)}}:e.prototype._next,c._error=s?function(i){try{s(i)}catch(u){r.error(u)}finally{this.unsubscribe()}}:e.prototype._error,c._complete=o?function(){try{o()}catch(i){r.error(i)}finally{this.unsubscribe()}}:e.prototype._complete,c}return t.prototype.unsubscribe=function(){var r;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var n=this.closed;e.prototype.unsubscribe.call(this),!n&&((r=this.onFinalize)===null||r===void 0||r.call(this))}},t}(T),ae=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function se(e){return d(e==null?void 0:e.then)}function le(e){return d(e[I])}function ce(e){return Symbol.asyncIterator&&d(e==null?void 0:e[Symbol.asyncIterator])}function ie(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function ue(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var fe=ue();function de(e){return d(e==null?void 0:e[fe])}function me(e){return C(this,arguments,function(){var r,n,o,s;return A(this,function(a){switch(a.label){case 0:r=e.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,y(r.read())];case 3:return n=a.sent(),o=n.value,s=n.done,s?[4,y(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,y(o)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return r.releaseLock(),[7];case 10:return[2]}})})}function ve(e){return d(e==null?void 0:e.getReader)}function E(e){if(e instanceof m)return e;if(e!=null){if(le(e))return pe(e);if(ae(e))return he(e);if(se(e))return ye(e);if(ce(e))return L(e);if(de(e))return be(e);if(ve(e))return we(e)}throw ie(e)}function pe(e){return new m(function(t){var r=e[I]();if(d(r.subscribe))return r.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function he(e){return new m(function(t){for(var r=0;r<e.length&&!t.closed;r++)t.next(e[r]);t.complete()})}function ye(e){return new m(function(t){e.then(function(r){t.closed||(t.next(r),t.complete())},function(r){return t.error(r)}).then(null,U)})}function be(e){return new m(function(t){var r,n;try{for(var o=V(e),s=o.next();!s.done;s=o.next()){var a=s.value;if(t.next(a),t.closed)return}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}t.complete()})}function L(e){return new m(function(t){ke(e,t).catch(function(r){return t.error(r)})})}function we(e){return L(me(e))}function ke(e,t){var r,n,o,s;return P(this,void 0,void 0,function(){var a,l;return A(this,function(c){switch(c.label){case 0:c.trys.push([0,5,6,11]),r=R(e),c.label=1;case 1:return[4,r.next()];case 2:if(n=c.sent(),!!n.done)return[3,4];if(a=n.value,t.next(a),t.closed)return[2];c.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return l=c.sent(),o={error:l},[3,11];case 6:return c.trys.push([6,,9,10]),n&&!n.done&&(s=r.return)?[4,s.call(r)]:[3,8];case 7:c.sent(),c.label=8;case 8:return[3,10];case 9:if(o)throw o.error;return[7];case 10:return[7];case 11:return t.complete(),[2]}})})}function S(e,t){return ne(function(r,n){var o=null,s=0,a=!1,l=function(){return a&&!o&&n.complete()};r.subscribe(k(n,function(c){o==null||o.unsubscribe();var i=0,u=s++;E(e(c,u)).subscribe(o=k(n,function(p){return n.next(t?t(c,p,u,i++):p)},function(){o=null,l()}))},function(){a=!0,l()}))})}const xe=["value"],_e={__name:"Checkbox",props:{checked:{type:[Array,Boolean],required:!0},value:{default:null}},emits:["update:checked"],setup(e,{emit:t}){const r=t,n=e,o=B({get(){return n.checked},set(s){r("update:checked",s)}});return(s,a)=>F((b(),w("input",{type:"checkbox",value:e.value,"onUpdate:modelValue":a[0]||(a[0]=l=>o.value=l),class:"rounded-md appearance-none w-4 h-4 border-2 border-gray-600 outline outline-transparent transition-all focus:outline-offset-2 checked:border-transparent focus:outline-lime-600 checked:bg-lime-600"},null,8,xe)),[[$,o.value]])}},ge=ee(_e,[["__scopeId","data-v-6c7a7bf9"]]);function Se(e,t){t===void 0&&(t={});var r=t.selector,n=N(t,["selector"]);return new m(function(o){var s=new AbortController,a=s.signal,l=!0,c=n.signal;if(c)if(c.aborted)s.abort();else{var i=function(){a.aborted||s.abort()};c.addEventListener("abort",i),o.add(function(){return c.removeEventListener("abort",i)})}var u=x(x({},n),{signal:a}),p=function(h){l=!1,o.error(h)};return fetch(e,u).then(function(h){r?E(r(h)).subscribe(k(o,void 0,function(){l=!1,o.complete()},p)):(l=!1,o.next(h),o.complete())}).catch(p),function(){l&&s.abort()}})}const Ie={key:0,class:"mb-4 font-medium text-sm text-green-600"},Ae={class:"mt-4"},Ee={class:"block mt-4"},Le={class:"flex items-center"},Oe=f("span",{class:"ms-2 text-sm text-gray-600"},"Запомнить меня",-1),Te={class:"flex items-center justify-end mt-4"},Pe=G({__name:"Login",props:{canResetPassword:{type:Boolean},status:{type:String}},setup(e){const t=Z(),r={email:"",password:"",remember:!1,processing:!1},n=new j,o=n.pipe(S(({email:s,password:a})=>Se("/api/v1/login",{selector:l=>l.json(),method:"POST",body:JSON.stringify({email:s,password:a}),headers:{"Content-Type":"application/json"}})),S(async s=>(await(globalThis==null?void 0:globalThis.cookieStore.set(W,s.token)),await t.push("/"),of(s)))).subscribe(q);return z(()=>{n.complete(),o.unsubscribe()}),(s,a)=>(b(),w(X,null,[e.status?(b(),w("div",Ie,D(e.status),1)):M("",!0),f("form",{onSubmit:a[3]||(a[3]=H(l=>Q(n).next(r),["prevent"]))},[f("div",null,[v(_,{for:"email",value:"Email"}),v(g,{id:"email",type:"email",class:"mt-1 block w-full",modelValue:r.email,"onUpdate:modelValue":a[0]||(a[0]=l=>r.email=l),placeholder:"Email",required:"",autofocus:"",autocomplete:"username"},null,8,["modelValue"])]),f("div",Ae,[v(_,{for:"password",value:"Пароль"}),v(g,{id:"password",type:"password",class:"mt-1 block w-full",placeholder:"Пароль",modelValue:r.password,"onUpdate:modelValue":a[1]||(a[1]=l=>r.password=l),required:"",autocomplete:"current-password"},null,8,["modelValue"])]),f("div",Ee,[f("label",Le,[v(ge,{name:"remember",checked:r.remember,"onUpdate:checked":a[2]||(a[2]=l=>r.remember=l)},null,8,["checked"]),Oe])]),f("div",Te,[v(re,{class:Y(["ms-4",{"opacity-25":r.processing}]),disabled:r.processing},{default:J(()=>[K(" Войти ")]),_:1},8,["class","disabled"])])],32)],64))}});export{Pe as default};
