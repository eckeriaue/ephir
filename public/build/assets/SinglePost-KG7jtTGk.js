import{d as T,r as l,p as j,o as i,c as d,b as s,B as $,k as v,j as w,F as B,l as k,t as r,u as p,e as g,q as L,G as M,w as N,H as P,I as A,h as I,i as F,T as E}from"./app-BqXTj1wH.js";import{_ as V}from"./Posts-itYolLqT.js";import{a as H}from"./InputLabel-dAOwWe2N.js";import{e as S}from"./auth-FOOteaxD.js";import{_ as D}from"./_plugin-vue_export-helper-x3n3nnut.js";const U=c=>(P("data-v-04069a9d"),c=c(),A(),c),q={class:"min-h-0"},G=U(()=>s("h2",{class:"text-xs font-medium px-6 pb-2 uppercase"}," КОММЕНТАРИИ ",-1)),O={class:"text-gray-500 text-xs inline-block"},R=["textContent"],Z={class:"text-sm text-gray-800"},z=["datetime"],J=["inert"],K=T({__name:"PostComments",props:{postId:{}},emits:["create"],setup(c,{emit:o}){const x=c,f=o,a=l(!0);async function _(m){p(a)||(a.value=!0);const e=await m;return a.value=!1,e}const n=l(),u=l("");async function h(){a.value=!0;const m=p(u);f("create",await S(`/posts/${x.postId}/comments/create`).post().auth().json({comment:m}).dispatch()),n.value=await _(y()),u.value=""}const C=new Intl.DateTimeFormat("ru-RU",{dateStyle:"long",timeStyle:"short",timeZone:"Europe/Moscow"});function y(){return S(`/posts/${x.postId}/comments`).get().query("limit",999).json().dispatch()}return j(async()=>{n.value=await _(y())}),(m,e)=>(i(),d("section",null,[s("div",q,[G,s("div",{class:$(["grid duration-500 transition-all",{"grid-rows-[0fr]":!n.value,"grid-rows-[1fr]":Array.isArray(n.value)}])},[v(M,{name:"list",tag:"ol",class:"space-y-4 px-6 min-h-0"},{default:w(()=>[(i(!0),d(B,null,L(n.value,t=>{var b;return i(),d("li",{key:t.id},[s("address",O,[k(" Автор: "),s("a",{role:"author",href:"#",textContent:r((b=t.user)==null?void 0:b.name)},null,8,R)]),s("p",Z,r(t.content),1),t.created_at?(i(),d("time",{key:0,datetime:new Date(t.created_at).toISOString(),class:"text-gray-500 text-[10px]"},r(p(C).format(new Date(t.created_at))),9,z)):g("",!0)])}),128))]),_:1})],2),s("form",{inert:a.value,class:$([{"opacity-50":a.value},"sticky bottom-0 flex items-center group w-full mt-6"]),action:"post",onSubmit:N(h,["prevent"])},[v(H,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=t=>u.value=t),class:"h-[36px] grow rounded-t-none rounded-r-none",placeholder:"Напишите свой комментарий"},null,8,["modelValue"]),v(V,{class:"h-[36px] group-focus-within:border-b-lime-600 border-b-2 rounded-l-none"},{default:w(()=>[k("📨")]),_:1})],42,J)])]))}}),Q=D(K,[["__scopeId","data-v-04069a9d"]]),W=["data-id"],X={class:"flex justify-between lg:items-center pb-6 flex-col lg:flex-row"},Y={class:"font-medium text-xl"},ee=["datetime"],te=["innerHTML"],se={class:"flex justify-between"},oe={key:0,class:"text-gray-500 text-xs inline-block"},ae=["textContent"],ne={class:"flex items-center gap-x-2"},re=["disabled"],ie=T({__name:"SinglePost",props:{id:{default:NaN},title:{default:""},likes_count:{},my_like:{},user:{default:()=>({})},comments_count:{},content:{default:""},created_at:{}},setup(c){const o=c,x=new Intl.DateTimeFormat("ru-RU",{dateStyle:"medium",timeZone:"Europe/Moscow"}),f=l(!1),a=l(!1),_=l(o.likes_count),n=l(o.my_like),u=l(o.comments_count),h=I(()=>p(n)&&"id"in p(n));async function C(){f.value=!0;const e=await S(`/posts/${o.id}/like`).post().json().auth().dispatch();_.value=e.likes,n.value=e.my_like,f.value=!1}const y=I(()=>o.created_at?x.format(new Date(o.created_at)):""),m=new Date(o.created_at).toISOString();return(e,t)=>(i(),d("article",{"data-id":e.$props.id,class:"text-gray-700 mb-7 bg-white rounded-xl p-6 border-b-2 border-gray-200"},[s("header",X,[s("h1",Y,r(e.title),1),o.created_at?(i(),d("time",{key:0,class:"text-gray-500 text-xs",datetime:p(m)},r(y.value),9,ee)):g("",!0)]),e.content?(i(),d("p",{key:0,class:"break-words mb-8",innerHTML:e.content},null,8,te)):g("",!0),s("footer",se,[e.user&&"name"in e.user?(i(),d("address",oe,[k(" Автор: "),s("a",{rel:"author",href:"#",textContent:r(e.user.name)},null,8,ae)])):g("",!0),s("fieldset",ne,[v(V,{onClick:t[0]||(t[0]=b=>a.value=!a.value)},{default:w(()=>[k(" 💬 "+r(u.value),1)]),_:1}),s("button",{type:"button",disabled:f.value,class:$([{"bg-red-600 border-transparent  text-white   hover:bg-red-500 active:bg-red-700  focus:ring-2 focus:ring-red-500":h.value,"bg-white border-gray-300 text-gray-700 shadow-sm hover:bg-gray-50 focus:ring-2 focus:ring-lime-500":!h.value},"px-4 py-2 disabled:pointer-events-none border inline-flex items-center tracking-widest uppercase focus:outline-none rounded-md disabled:opacity-25 font-semibold text-xs focus:ring-offset-2 transition ease-in-out duration-150"]),onClick:C},r(h.value?"🤍":"❤️")+" "+r(_.value),11,re)])]),v(E,null,{default:w(()=>[a.value?(i(),F(Q,{key:0,onCreate:t[1]||(t[1]=b=>u.value+=1),"post-id":e.$props.id,class:"transition-all duration-500 overflow-hidden mt-6 -mx-6 -mb-6"},null,8,["post-id"])):g("",!0)]),_:1})],8,W))}}),pe=D(ie,[["__scopeId","data-v-668a4c57"]]);export{pe as default};
