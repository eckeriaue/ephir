var y=Object.defineProperty;var S=(n,r,t)=>r in n?y(n,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[r]=t;var m=(n,r,t)=>(S(n,typeof r!="symbol"?r+"":r,t),t);const b=decodeURIComponent,C=/; */;function T(n,r){try{return typeof r=="boolean"?decodeURIComponent(n):r(n)}catch{return n}}const u=Object.freeze({strict:"strict",lax:"lax",none:"none"});function v(n,r={}){if(typeof n!="string")throw new TypeError("argument str must be a string");const t=[],o=r||{},e=n.split(C),s=o.decode||b;for(let i=0;i<e.length;i++){const a=e[i];let l=a.indexOf("=");if(l<0)continue;const h=a.substr(0,l).trim();let c=a.substr(++l,a.length).trim();c[0]=='"'&&(c=c.slice(1,-1)),t[h]==null&&t.push({name:h,value:T(c,s)})}return t}class d extends Event{constructor(t,o={changed:[],deleted:[]}){super(t,o);m(this,"changed");m(this,"deleted");this.changed=o.changed||[],this.deleted=o.deleted||[]}}class w extends EventTarget{constructor(){super();m(this,"onchange");throw new TypeError("Illegal Constructor")}get[Symbol.toStringTag](){return"CookieStore"}async get(t){if(t==null)throw new TypeError("CookieStoreGetOptions must not be empty");if(t instanceof Object&&!Object.keys(t).length)throw new TypeError("CookieStoreGetOptions must not be empty");return(await this.getAll(t))[0]}async set(t,o){var a,l,h;const e={name:"",value:"",path:"/",secure:!1,sameSite:u.strict,expires:null,domain:null};if(typeof t=="string")e.name=t,e.value=o;else{if(Object.assign(e,t),e.path&&!e.path.startsWith("/"))throw new TypeError('Cookie path must start with "/"');if((a=e.domain)!=null&&a.startsWith("."))throw new TypeError('Cookie domain cannot start with "."');if(e.domain&&e.domain!==window.location.hostname)throw new TypeError("Cookie domain must domain-match current host");if((l=e.name)!=null&&l.startsWith("__Host")&&e.domain)throw new TypeError("Cookie domain must not be specified for host cookies");if((h=e.name)!=null&&h.startsWith("__Host")&&e.path!="/")throw new TypeError("Cookie path must not be specified for host cookies");e.path&&e.path.endsWith("/")&&(e.path=e.path.slice(0,-1)),e.path===""&&(e.path="/")}if(e.name===""&&e.value&&e.value.includes("="))throw new TypeError("Cookie value cannot contain '=' if the name is empty");e.name&&e.name.startsWith("__Host")&&(e.secure=!0);let s=`${e.name}=${encodeURIComponent(e.value)}`;switch(e.domain&&(s+="; Domain="+e.domain),e.path&&(s+="; Path="+e.path),typeof e.expires=="number"?s+="; Expires="+new Date(e.expires).toUTCString():e.expires instanceof Date&&(s+="; Expires="+e.expires.toUTCString()),(e.name&&e.name.startsWith("__Secure")||e.secure)&&(e.sameSite=u.lax,s+="; Secure"),e.sameSite){case u.lax:s+="; SameSite=Lax";break;case u.strict:s+="; SameSite=Strict";break;case u.none:s+="; SameSite=None";break}const i=this.get(e);if(document.cookie=s,this.onchange){const c=[],g=[];i&&!await this.get(e)?g.push({...e,value:void 0}):c.push(e);const k=new d("change",{changed:c,deleted:g});this.onchange(k)}}async getAll(t){const o=v(document.cookie);if(t==null||Object.keys(t).length===0)return o;let e,s;if(typeof t=="string"?e=t:(e=t.name,s=t.url),s){const i=new URL(s,window.location.origin);if(window.location.href!==i.href||window.location.origin!==i.origin)throw new TypeError("URL must match the document URL");return o.slice(0,1)}return o.filter(i=>i.name===e)}async delete(t){const o={name:"",value:"",path:"/",secure:!1,sameSite:u.strict,expires:null,domain:null};typeof t=="string"?o.name=t:Object.assign(o,t),o.expires=0,await this.set(o)}}const p=new WeakMap,f=new WeakMap;class E{get[Symbol.toStringTag](){return"CookieStoreManager"}constructor(){throw new TypeError("Illegal Constructor")}async subscribe(r){const t=p.get(this)||[],o=f.get(this);if(!o)throw new TypeError("Illegal invocation");for(const e of r){const s=e.name,i=new URL(e.url||"",o.scope).toString();t.some(a=>a.name===s&&a.url===i)||t.push({name:e.name,url:i})}p.set(this,t)}async getSubscriptions(){return(p.get(this)||[]).map(({name:r,url:t})=>({name:r,url:t}))}async unsubscribe(r){let t=p.get(this)||[];const o=f.get(this);if(!o)throw new TypeError("Illegal invocation");for(const e of r){const s=e.name,i=new URL(e.url||"",o.scope).toString();t=t.filter(a=>a.name!==s||a.url!==i)}p.set(this,t)}}"cookies"in ServiceWorkerRegistration.prototype||Object.defineProperty(ServiceWorkerRegistration.prototype,"cookies",{configurable:!0,enumerable:!0,get(){const n=Object.create(E.prototype);return f.set(n,this),Object.defineProperty(this,"cookies",{value:n}),n}});const x=Object.create(w.prototype);Reflect.has(globalThis,"cookieStore")||(globalThis.ServiceWorkerRegistration=ServiceWorkerRegistration,globalThis.cookieStore=x,globalThis.CookieStore=w,globalThis.CookieChangeEvent=d);
